(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{24994:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings",function(){return n(99176)}])},68587:function(e,t,n){"use strict";n.d(t,{Q:function(){return l}});let i={GitHub:"gitHub"};var r=n(52322),o=n(70647);let l={gitHub:{connect:async()=>await s("gitHub"),Icon:e=>(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,r.jsx)("path",{d:"M12 4C7.57486 4 4 7.57486 4 12C4 15.5246 6.30057 18.5257 9.47429 19.6C9.87429 19.6754 10.0251 19.4251 10.0251 19.2251V17.8754C7.8 18.3497 7.32457 16.8 7.32457 16.8C6.94971 15.8743 6.42514 15.6251 6.42514 15.6251C5.70057 15.1246 6.47543 15.1497 6.47543 15.1497C7.27543 15.2 7.69943 15.9749 7.69943 15.9749C8.42514 17.2 9.57486 16.8503 10.0251 16.6491C10.1006 16.1246 10.2994 15.7749 10.5246 15.5749C8.74971 15.3749 6.87543 14.6754 6.87543 11.6251C6.87543 10.7497 7.17486 10.0503 7.69943 9.47543C7.62514 9.27543 7.34971 8.45029 7.77486 7.34971C7.77486 7.34971 8.44914 7.12457 9.97486 8.17486C10.6266 7.99627 11.2991 7.90405 11.9749 7.90057C12.6491 7.90057 13.3497 8 13.9749 8.17486C15.5006 7.14971 16.1749 7.34971 16.1749 7.34971C16.6 8.45029 16.3246 9.27543 16.2503 9.47543C16.776 10.024 17.0754 10.7497 17.0754 11.624C17.0754 14.6994 15.2 15.3749 13.4251 15.5749C13.6994 15.8251 13.9749 16.2994 13.9749 17.0491V19.2503C13.9749 19.4754 14.1246 19.7246 14.5246 19.6251C17.7006 18.5246 20 15.5246 20 12C20 7.57486 16.4251 4 12 4Z",fill:"currentColor"})}),name:"GitHub",supported:c("gitHub")},bitbucket:{connect:async()=>await s("bitbucket"),Icon:e=>(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.77596 5.47599C4.84147 5.44648 4.91265 5.43167 4.9845 5.4326L19.3525 5.43506C19.4243 5.43413 19.4955 5.44894 19.561 5.47845C19.6265 5.50796 19.6848 5.55146 19.7317 5.60588C19.7786 5.6603 19.8131 5.72433 19.8326 5.79348C19.8521 5.86262 19.8563 5.93521 19.8448 6.00614L19.1802 10.0751H9.71803L10.5722 14.6018H11.1162L11.1162 14.6018H13.7846L14.56 10.0751H19.1803L17.7575 18.8357C17.7387 18.9522 17.6786 19.058 17.5882 19.1339C17.4979 19.2098 17.3832 19.2507 17.2652 19.2492H7.23692C7.2134 19.249 7.19001 19.2476 7.16682 19.2449C7.03392 19.2298 6.90803 19.175 6.80603 19.0868C6.68704 18.9851 6.60772 18.8448 6.58203 18.6904L4.49219 6.00367C4.48069 5.93275 4.48485 5.86016 4.50438 5.79102C4.52392 5.72187 4.55835 5.65784 4.60527 5.60342C4.65218 5.54899 4.71044 5.5055 4.77596 5.47599Z",fill:"currentColor"})}),name:"Bitbucket",supported:c("bitbucket")},gitLab:{connect:async()=>await s("gitLab"),Icon:e=>(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.7881 10.5954L16.5431 5.20756C16.6328 4.93081 17.0594 4.93081 17.1492 5.20756L18.9076 10.5954H14.7881ZM6.6192 5.20756L4.86353 10.5954H8.97968L7.22468 5.20756C7.1349 4.93081 6.70898 4.93081 6.6192 5.20756ZM4.0299 13.2981L4.86352 10.5954H4.86353H8.979H14.7881H18.9076L19.7392 13.2981C19.7796 13.4207 19.7802 13.553 19.7408 13.676C19.7014 13.799 19.624 13.9063 19.5198 13.9826L11.893 19.5257L11.8879 19.5319L11.8923 19.5378L11.8865 19.5336L11.8835 19.5371L11.8852 19.5326L4.24927 13.9826C4.0299 13.8246 3.95092 13.5458 4.0299 13.2981Z",fill:"currentColor"})}),name:"GitLab",supported:c("gitLab")}};async function s(e){if(!c(e))throw Error("Not implemented.");let t=await o.managerClient.git.getProviderAppInstallURL({provider:e});window.open(t,"git-provider-app-installation")}function c(e){return!!Object.values(i).includes(e)}},6407:function(e,t,n){"use strict";n.d(t,{G:function(){return l}});var i=n(18566),r=n(29806),o=n(70647);function l(){let[e]=(0,r.f)();return{linkedGitRepos:(0,i.QT)(s,[e.repositoryName]),linkRepo:async t=>{await o.managerClient.git.linkRepo({prismic:{domain:e.repositoryName},git:t}),await (0,i.gw)(s,[e.repositoryName])},unlinkRepo:async t=>{await o.managerClient.git.unlinkRepo({prismic:{domain:e.repositoryName},git:t}),await (0,i.gw)(s,[e.repositoryName])}}}async function s(e){return await o.managerClient.git.fetchLinkedRepos({prismic:{domain:e}})}},29806:function(e,t,n){"use strict";n.d(t,{f:function(){return o}});var i=n(18566),r=n(70647);function o(){return[(0,i.QT)(l,[]),async e=>{await r.managerClient.project.writeSliceMachineConfig({config:e}),(0,i.VA)(l,[],e)}]}async function l(){return r.managerClient.project.getSliceMachineConfig()}},99176:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return er}});var i=n(52322),r=n(7729),o=n(97729),l=n.n(o),s=n(5632),c=n(2784),a=n(23335),d=n(37792),u=n(17783),x=n.n(u);let h=e=>(0,i.jsx)("div",{...e,className:x().root}),g=e=>{let{children:t,...n}=e;return(0,i.jsx)("div",{...n,className:x().legend,children:(0,i.jsx)(r.xvT,{color:"grey11",component:"span",noWrap:!0,variant:"smallBold",children:t})})},m=e=>(0,i.jsx)("div",{...e,className:x().header}),j=e=>(0,i.jsx)("div",{...e,className:x().content}),_=e=>(0,i.jsx)("ul",{...e,className:x().list}),p=e=>{let{action:t,children:n,...o}=e;return(0,i.jsxs)("li",{...o,className:x().listItem,children:[(0,i.jsx)(r.xvT,{component:"span",noWrap:!0,variant:"bold",sx:{flexGrow:1},children:n}),t]})},f=e=>{let{action:t,children:n,...o}=e;return(0,i.jsxs)("div",{...o,className:x().footer,children:[(0,i.jsx)(r.xvT,{color:"grey11",component:"span",noWrap:!0,variant:"small",sx:{flexGrow:1},children:n}),t]})};var w=n(30988);let v=e=>{let{title:t,description:n,action:o}=e;return(0,i.jsxs)(r.xuv,{flexDirection:"column",padding:{block:72,inline:100},children:[(0,i.jsx)(r.xvT,{align:"center",variant:"emphasized",children:t}),(0,i.jsx)(r.xvT,{align:"center",color:"grey11",children:n}),o?(0,i.jsx)(r.hE2,{sx:{alignSelf:"center",marginTop:8},children:o}):void 0]})};var C=n(98863),b=n(88932),y=n(68587);let S=()=>(0,i.jsx)(r.hE2,{children:(0,C.XP)(y.Q).map(e=>(0,i.jsx)(k,{provider:e,sx:{flexBasis:0,flexGrow:1}},e))}),k=e=>{let{provider:t,sx:n}=e,{connect:o,Icon:l,name:s,supported:a}=y.Q[t],[d,u]=(0,c.useState)(!1);return(0,i.jsxs)(r.zxk,{color:"grey",disabled:!a,loading:d,onClick:()=>{(async()=>{u(!0);try{await o()}catch(t){let e="Could not connect to ".concat(s);console.error(e,t),b.Am.error(e),u(!1)}})()},renderStartIcon:()=>(0,i.jsx)(l,{color:r.rSc.color.grey11}),sx:n,children:[s,a?void 0:(0,i.jsx)(r.xvT,{color:"inherit",variant:"small",children:" (soon)"})]})},F=e=>{let{date:t,...n}=e;return(0,i.jsx)(r.xvT,{...n,color:"inherit",variant:"inherit",children:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return L.format(Math.round((+T(e)-+T(t))/864e5),"day")}(t)})},L=new Intl.RelativeTimeFormat("en",{numeric:"auto",style:"narrow"});function T(e){let t=new Date(e);return t.setHours(0,0,0,0),t}var Z=n(63397),I=n(29806),R=n(70647),P=n(99579);let N=e=>{let{linkRepo:t,repo:n,trigger:o}=e,l=y.Q[n.provider],{updateToken:s}=function(e){let[t]=(0,I.f)();return{updateToken:async n=>{await R.managerClient.git.updateWriteAPIToken({prismic:{domain:t.repositoryName},git:e.git,token:n})}}}({git:n}),{repositoryUrl:c}=(0,P.U)();return(0,i.jsxs)(r.VqE,{size:{width:448,height:"auto"},trigger:o,children:[(0,i.jsx)(r.fKu,{title:"Prismic Write API token required"}),(0,i.jsx)(r.cZJ,{children:(0,i.jsx)(Z.J9,{initialValues:{writeAPIToken:""},validate:e=>{if(0===e.writeAPIToken.length)return{writeAPIToken:"Cannot be empty"}},onSubmit:async e=>{try{await t(n),await s(e.writeAPIToken)}catch(t){let e="Could not connect to ".concat(n.name);console.error(e,t),b.Am.error(e)}},children:e=>(0,i.jsxs)("form",{onSubmit:e.handleSubmit,children:[(0,i.jsxs)(r.xuv,{flexDirection:"column",gap:4,padding:16,children:[(0,i.jsx)(r.ytj,{disabled:e.isSubmitting,error:"string"==typeof e.errors.writeAPIToken,label:"Paste your Write API token",onValueChange:t=>{e.setFieldValue("writeAPIToken",t)},placeholder:"Write API token",value:e.values.writeAPIToken}),(0,i.jsxs)(r.xvT,{color:"grey11",children:["Required to sync models from ",l.name," to Prismic."]})]}),(0,i.jsxs)(r.kXR,{children:[(0,i.jsx)(r.qEi,{href:new URL("/settings/apps",c).href,children:"Create a Prismic Write API token"}),(0,i.jsx)(r.POh,{size:"medium"}),(0,i.jsx)(r._dX,{disabled:!e.isValid,loading:e.isSubmitting,onClick:()=>void e.submitForm(),size:"medium",children:"Save Token"})]})]})})})]})},H=e=>{let{repo:t,trigger:n,unlinkRepo:o}=e,[l,s]=(0,c.useState)(!1);return(0,i.jsxs)(r.VqE,{size:{width:448,height:"auto"},trigger:n,children:[(0,i.jsx)(r.fKu,{title:"Remove Git Connection"}),(0,i.jsx)(r.cZJ,{children:(0,i.jsx)(r.xuv,{flexDirection:"column",padding:16,children:(0,i.jsx)(r.xvT,{children:"You will not be able to push your code alongside your models anymore. Note that you can reconnect your Git repository at any time. Are you sure you want to continue?"})})}),(0,i.jsxs)(r.kXR,{children:[(0,i.jsx)(r.POh,{size:"medium"}),(0,i.jsx)(r._dX,{size:"medium",color:"tomato",loading:l,onClick:()=>{(async()=>{s(!0);try{await o(t)}catch(n){let e="Could not disconnect from ".concat(t.name);console.error(e,n),b.Am.error(e)}s(!1)})()},children:"Disconnect"})]})]})};var W=n(6407);let A=e=>{let{mode:t,repos:n}=e,{linkRepo:o,unlinkRepo:l}=(0,W.G)();return(0,i.jsx)(_,{children:"link"===t?n.map(e=>(0,i.jsxs)(p,{action:(0,i.jsx)(N,{linkRepo:o,repo:e,trigger:(0,i.jsx)(r.zxk,{color:"grey",children:"Connect"})}),children:[e.name,(0,i.jsxs)(r.xvT,{color:"grey11",children:[" â€¢ ",(0,i.jsx)(F,{date:e.pushedAt})]})]},"".concat(e.provider,"@").concat(e.id))):n.map(e=>(0,i.jsx)(p,{action:(0,i.jsx)(H,{repo:e,trigger:(0,i.jsx)(r.zxk,{color:"grey",children:"Disconnect"}),unlinkRepo:l}),children:e.name},"".concat(e.provider,"@").concat(e.owner,"/").concat(e.name)))})},D=()=>(0,i.jsx)(_,{children:[...[,,,,].keys()].map(e=>(0,i.jsx)(p,{action:(0,i.jsx)(r.OdW,{height:32,width:67.59}),children:(0,i.jsx)(r.OdW,{height:24,sx:{verticalAlign:"middle"},width:129.92})},e))}),G=e=>{let{disabled:t,owners:n=[],selectedOwner:o,onSelectedOwnerChange:l,sx:s}=e;return(0,i.jsx)(r.PhF,{color:"grey",constrainContentWidth:!0,disabled:t,flexContent:!0,onValueChange:e=>{let[t,i]=e.split("@"),r=n.find(e=>e.provider===t&&e.id===i);r&&(null==l||l(r))},placeholder:"Owner",renderStartIcon:()=>(0,i.jsx)(z,{owner:o}),size:"large",sx:s,value:o?M(o):void 0,children:n.map(e=>(0,i.jsx)(r.QlF,{renderStartIcon:()=>(0,i.jsx)(z,{owner:e}),size:"large",value:M(e),children:e.name},M(e)))})},z=e=>{var t;let{owner:n}=e,{Icon:o}=y.Q[null!==(t=null==n?void 0:n.provider)&&void 0!==t?t:"gitHub"];return(0,i.jsx)(o,{color:r.rSc.color.grey11})};function M(e){return"".concat(e.provider,"@").concat(e.id)}var V=n(18566);async function O(e,t,n,i){return await R.managerClient.git.fetchRepos({provider:e,owner:t,query:n,page:i})}let E=e=>{let{owners:t}=e,[n,r]=(0,c.useState)(t[0]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m,{children:(0,i.jsx)(G,{owners:t,selectedOwner:n,onSelectedOwnerChange:r,sx:{width:"calc(50% - 8px)"}})}),(0,i.jsx)(c.Suspense,{fallback:(0,i.jsx)(Q,{gitOwnerSelect:!1}),children:(0,i.jsx)(B,{owner:n})})]})},B=e=>{var t;let{owner:n}=e,r=(t={provider:n.provider,owner:n.name},(0,V.QT)(O,[t.provider,t.owner,t.query,t.page]));return r.length>0?(0,i.jsx)(A,{mode:"link",repos:r}):(0,i.jsx)(j,{children:(0,i.jsx)(v,{title:"No Results Found",description:"Try selecting a different Git account or organization on the top left."})})},Q=e=>{let{gitOwnerSelect:t}=e;return(0,i.jsxs)(i.Fragment,{children:[t?(0,i.jsx)(m,{children:(0,i.jsx)(G,{disabled:!0,sx:{width:"calc(50% - 8px)"}})}):void 0,(0,i.jsx)(D,{})]})};async function q(){return await R.managerClient.git.fetchOwners()}var K=n(41067);let X=()=>(0,i.jsxs)(h,{children:[(0,i.jsx)(g,{children:"Connected Git Repository"}),(0,i.jsx)(w.S,{renderError:J,children:(0,i.jsx)(c.Suspense,{fallback:(0,i.jsx)(Q,{gitOwnerSelect:!0}),children:(0,i.jsx)(U,{})})}),(0,i.jsx)(f,{action:(0,i.jsx)(r.ua7,{content:"Documentation is coming soon.",side:"bottom",children:(0,i.jsx)(r.hU,{disabled:!0,icon:"openInNew"})}),children:"Learn more about Prismic for Git"})]}),U=()=>{let{linkedGitRepos:e}=(0,W.G)();return e.length>0?(0,i.jsx)(A,{mode:"unlink",repos:e}):(0,i.jsx)(Y,{})},Y=()=>{let e=(0,V.QT)(q,[]);return e.length>0?(0,i.jsx)(E,{owners:e}):(0,i.jsx)(j,{children:(0,i.jsx)(S,{})})};function J(e,t){return(0,d.ff)(e)?(0,i.jsx)($,{}):(0,d.TW)(e)?(0,i.jsx)(ee,{}):(0,i.jsx)(et,{reset:t})}let $=()=>{let{openLoginModal:e}=(0,K.Z)();return(0,i.jsx)(j,{children:(0,i.jsx)(v,{title:"It seems like you are logged out",description:"Log in to connect a Git repository.",action:(0,i.jsx)(r.zxk,{onClick:e,children:"Log in to Prismic"})})})},ee=()=>(0,i.jsx)(j,{children:(0,i.jsx)(v,{title:"It seems like you do not have permission",description:"An owner or admin is required to connect a Git repository."})}),et=e=>{let{reset:t}=e;return(0,i.jsx)(j,{children:(0,i.jsx)(v,{title:"Unable to fetch data",description:"An error occurred while fetching the list of connected Git repositories.",action:(0,i.jsx)(r.zxk,{color:"grey",onClick:t,children:"Retry"})})})};var en=n(52677),ei=n(5335);let er=()=>{let e=(0,en.M)(),t=(0,s.useRouter)();return((0,c.useEffect)(()=>{e.eligible||t.replace("/")},[e.eligible,t]),e.eligible)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l(),{children:(0,i.jsx)("title",{children:"Settings - Slice Machine"})}),(0,i.jsxs)(ei.LN,{children:[(0,i.jsx)(ei.wd,{children:(0,i.jsx)(ei.Cx,{children:(0,i.jsx)(a.g,{children:"Settings"})})}),(0,i.jsx)(ei.RN,{children:(0,i.jsx)(r.xuv,{flexDirection:"column",maxWidth:600,children:(0,i.jsx)(X,{})})})]})]}):null}},17783:function(e){e.exports={flex:"FieldSet_flex__r2Zbg",column:"FieldSet_column__esHjW FieldSet_flex__r2Zbg",root:"FieldSet_root__MYqY8 FieldSet_column__esHjW FieldSet_flex__r2Zbg",row:"FieldSet_row__DZZjD FieldSet_flex__r2Zbg",borderBottom:"FieldSet_borderBottom__WVCMK",legend:"FieldSet_legend__4k9_l FieldSet_row__DZZjD FieldSet_flex__r2Zbg FieldSet_borderBottom__WVCMK",header:"FieldSet_header__cR_f3 FieldSet_row__DZZjD FieldSet_flex__r2Zbg FieldSet_borderBottom__WVCMK",content:"FieldSet_content__WzxRs FieldSet_column__esHjW FieldSet_flex__r2Zbg",list:"FieldSet_list__mILoo FieldSet_column__esHjW FieldSet_flex__r2Zbg",listItem:"FieldSet_listItem__QOhSB FieldSet_row__DZZjD FieldSet_flex__r2Zbg FieldSet_borderBottom__WVCMK",borderTop:"FieldSet_borderTop__KfoL_",footer:"FieldSet_footer__1VWxY FieldSet_row__DZZjD FieldSet_flex__r2Zbg FieldSet_borderTop__KfoL_"}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=24994)}),_N_E=e.O()}]);